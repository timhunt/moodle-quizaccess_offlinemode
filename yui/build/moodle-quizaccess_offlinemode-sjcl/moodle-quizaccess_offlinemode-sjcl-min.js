YUI.add("moodle-quizaccess_offlinemode-sjcl",function(t,e){"use strict";var i,y={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};y.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var e,i,n,r,s,o=this._tables[0][4],a=this._tables[1],c=t.length,h=1;if(4!==c&&6!==c&&8!==c)throw new y.exception.invalid("invalid aes key size");for(this._key=[r=t.slice(0),s=[]],e=c;e<4*c+28;e++)n=r[e-1],(e%c==0||8===c&&e%c==4)&&(n=o[n>>>24]<<24^o[n>>16&255]<<16^o[n>>8&255]<<8^o[255&n],e%c==0&&(n=n<<8^n>>>24^h<<24,h=h<<1^283*(h>>7))),r[e]=r[e-c]^n;for(i=0;e;i++,e--)n=r[3&i?e:e-4],s[i]=e<=4||i<4?n:a[0][o[n>>>24]]^a[1][o[n>>16&255]]^a[2][o[n>>8&255]]^a[3][o[255&n]]},y.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){for(var t,e,i,f,n,r,s,o=this._tables[0],a=this._tables[1],u=o[4],l=a[4],c=[],d=[],h=0;h<256;h++)d[(c[h]=h<<1^283*(h>>7))^h]=h;for(t=e=0;!u[t];t^=i||1,e=d[e]||1)for(s=16843009*c[f=c[i=c[l[u[t]=n=(n=e^e<<1^e<<2^e<<3^e<<4)>>8^255&n^99]=t]]]^65537*f^257*i^16843008*t,r=257*c[n]^16843008*n,h=0;h<4;h++)o[h][t]=r=r<<24^r>>>8,a[h][n]=s=s<<24^s>>>8;for(h=0;h<5;h++)o[h]=o[h].slice(0),a[h]=a[h].slice(0)},_crypt:function(t,e){if(4!==t.length)throw new y.exception.invalid("invalid aes block size");for(var i,f,u,n=this._key[e],r=t[0]^n[0],s=t[e?3:1]^n[1],o=t[2]^n[2],a=t[e?1:3]^n[3],l=n.length/4-2,c=4,d=[0,0,0,0],t=this._tables[e],p=t[0],b=t[1],m=t[2],_=t[3],g=t[4],h=0;h<l;h++)i=p[r>>>24]^b[s>>16&255]^m[o>>8&255]^_[255&a]^n[c],f=p[s>>>24]^b[o>>16&255]^m[a>>8&255]^_[255&r]^n[c+1],u=p[o>>>24]^b[a>>16&255]^m[r>>8&255]^_[255&s]^n[c+2],a=p[a>>>24]^b[r>>16&255]^m[s>>8&255]^_[255&o]^n[c+3],c+=4,r=i,s=f,o=u;for(h=0;h<4;h++)d[e?3&-h:h]=g[r>>>24]<<24^g[s>>16&255]<<16^g[o>>8&255]<<8^g[255&a]^n[c++],i=r,r=s,s=o,o=a,a=i;return d}},y.bitArray={bitSlice:function(t,e,i){return t=y.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),i===undefined?t:y.bitArray.clamp(t,i-e)},extract:function(t,e,i){var n=Math.floor(-e-i&31),e=-32&(e+i-1^e)?t[e/32|0]<<32-n^t[e/32+1|0]>>>n:t[e/32|0]>>>n;return e&(1<<i)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var i=t[t.length-1],n=y.bitArray.getPartial(i);return 32===n?t.concat(e):y.bitArray._shiftRight(e,n,0|i,t.slice(0,t.length-1))},bitLength:function(t){var e=t.length;return 0===e?0:(t=t[e-1],32*(e-1)+y.bitArray.getPartial(t))},clamp:function(t,e){if(32*t.length<e)return t;var i=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,0<i&&e&&(t[i-1]=y.bitArray.partial(e,t[i-1]&2147483648>>e-1,1)),t},partial:function(t,e,i){return 32===t?e:(i?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(y.bitArray.bitLength(t)!==y.bitArray.bitLength(e))return!1;for(var i=0,n=0;n<t.length;n++)i|=t[n]^e[n];return 0===i},_shiftRight:function(t,e,i,n){var r,s;for(n===undefined&&(n=[]);32<=e;e-=32)n.push(i),i=0;if(0===e)return n.concat(t);for(r=0;r<t.length;r++)n.push(i|t[r]>>>e),i=t[r]<<32-e;return s=t.length?t[t.length-1]:0,s=y.bitArray.getPartial(s),n.push(y.bitArray.partial(e+s&31,32<e+s?i:n.pop(),1)),n},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]},byteswapM:function(t){for(var e,i=0;i<t.length;++i)e=t[i],t[i]=e>>>24|e>>>8&65280|(65280&e)<<8|e<<24;return t}},y.codec.utf8String={fromBits:function(t){for(var e,i="",n=y.bitArray.bitLength(t),r=0;r<n/8;r++)0==(3&r)&&(e=t[r/4]),i+=String.fromCharCode(e>>>24),e<<=8;return decodeURIComponent(escape(i))},toBits:function(t){t=unescape(encodeURIComponent(t));for(var e=[],i=0,n=0;n<t.length;n++)i=i<<8|t.charCodeAt(n),3==(3&n)&&(e.push(i),i=0);return 3&n&&e.push(y.bitArray.partial(8*(3&n),i)),e}},y.codec.hex={fromBits:function(t){for(var e="",i=0;i<t.length;i++)e+=(0xf00000000000+(0|t[i])).toString(16).substr(4);return e.substr(0,y.bitArray.bitLength(t)/4)},toBits:function(t){var e,i=[],n=(t=t.replace(/\s|0x/g,"")).length;for(t+="00000000",e=0;e<t.length;e+=8)i.push(0^parseInt(t.substr(e,8),16));return y.bitArray.clamp(i,4*n)}},y.codec.base32={_chars:"0123456789abcdefghjkmnpqrstvwxyz",BITS:32,BASE:5,REMAINING:27,fromBits:function(t,h){y.codec.base32.BITS;for(var e=y.codec.base32.BASE,i=y.codec.base32.REMAINING,n="",r=0,s=y.codec.base32._chars,o=0,a=y.bitArray.bitLength(t),c=0;n.length*e<=a;)n+=s.charAt((o^t[c]>>>r)>>>i),r<e?(o=t[c]<<e-r,r+=i,c++):(o<<=e,r-=e);return n},toBits:function(t){for(var e,i=y.codec.base32.BITS,n=y.codec.base32.BASE,r=y.codec.base32.REMAINING,s=[],o=0,a=y.codec.base32._chars,c=0,h=0;h<t.length;h++){if((e=a.indexOf(t.charAt(h)))<0)throw new y.exception.invalid("this isn't base32!");r<o?(o-=r,s.push(c^e>>>o),c=e<<i-o):c^=e<<i-(o+=n)}return 56&o&&s.push(y.bitArray.partial(56&o,c,1)),s}},y.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,i){var n,r="",s=0,o=y.codec.base64._chars,a=0,c=y.bitArray.bitLength(t);for(i&&(o=o.substr(0,62)+"-_"),n=0;6*r.length<c;)r+=o.charAt((a^t[n]>>>s)>>>26),s<6?(a=t[n]<<6-s,s+=26,n++):(a<<=6,s-=6);for(;3&r.length&&!e;)r+="=";return r},toBits:function(t,e){t=t.replace(/\s|=/g,"");var i,n,r=[],s=0,o=y.codec.base64._chars,a=0;for(e&&(o=o.substr(0,62)+"-_"),i=0;i<t.length;i++){if((n=o.indexOf(t.charAt(i)))<0)throw new y.exception.invalid("this isn't base64!");26<s?(s-=26,r.push(a^n>>>s),a=n<<32-s):a^=n<<32-(s+=6)}return 56&s&&r.push(y.bitArray.partial(56&s,a,1)),r}},y.codec.base64url={fromBits:function(t){return y.codec.base64.fromBits(t,1,1)},toBits:function(t){return y.codec.base64.toBits(t,1)}},y.codec.bytes={
fromBits:function(t){for(var e,i=[],n=y.bitArray.bitLength(t),r=0;r<n/8;r++)0==(3&r)&&(e=t[r/4]),i.push(e>>>24),e<<=8;return i},toBits:function(t){for(var e=[],i=0,n=0;n<t.length;n++)i=i<<8|t[n],3==(3&n)&&(e.push(i),i=0);return 3&n&&e.push(y.bitArray.partial(8*(3&n),i)),e}},y.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},y.hash.sha256.hash=function(t){return(new y.hash.sha256).update(t).finalize()},y.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=y.codec.utf8String.toBits(t));for(var e=this._buffer=y.bitArray.concat(this._buffer,t),i=this._length,n=this._length=i+y.bitArray.bitLength(t),r=512+i&-512;r<=n;r+=512)this._block(e.splice(0,16));return this},finalize:function(){for(var t=this._buffer,e=this._h,i=(t=y.bitArray.concat(t,[y.bitArray.partial(1,1)])).length+2;15&i;i++)t.push(0);for(t.push(Math.floor(this._length/4294967296)),t.push(0|this._length);t.length;)this._block(t.splice(0,16));return this.reset(),e},_init:[],_key:[],_precompute:function(){var t,e=0,i=2;function n(t){return 4294967296*(t-Math.floor(t))|0}t:for(;e<64;i++){for(t=2;t*t<=i;t++)if(i%t==0)continue t;e<8&&(this._init[e]=n(Math.pow(i,.5))),this._key[e]=n(Math.pow(i,1/3)),e++}},_block:function(t){for(var e,i,n=t.slice(0),t=this._h,f=this._key,u=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],d=t[7],h=0;h<64;h++)e=(e=h<16?n[h]:(e=n[h+1&15],i=n[h+14&15],n[15&h]=(e>>>7^e>>>18^e>>>3^e<<25^e<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+n[15&h]+n[h+9&15]|0))+d+(a>>>6^a>>>11^a>>>25^a<<26^a<<21^a<<7)+(c^a&(l^c))+f[h],d=c,c=l,l=a,a=o+e|0,o=s,s=r,u=e+((r=u)&s^o&(r^s))+(r>>>2^r>>>13^r>>>22^r<<30^r<<19^r<<10)|0;t[0]=t[0]+u|0,t[1]=t[1]+r|0,t[2]=t[2]+s|0,t[3]=t[3]+o|0,t[4]=t[4]+a|0,t[5]=t[5]+l|0,t[6]=t[6]+c|0,t[7]=t[7]+d|0}},y.hash.sha512=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},y.hash.sha512.hash=function(t){return(new y.hash.sha512).update(t).finalize()},y.hash.sha512.prototype={blockSize:1024,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=y.codec.utf8String.toBits(t));for(var e=this._buffer=y.bitArray.concat(this._buffer,t),i=this._length,n=this._length=i+y.bitArray.bitLength(t),r=1024+i&-1024;r<=n;r+=1024)this._block(e.splice(0,32));return this},finalize:function(){for(var t=this._buffer,e=this._h,i=(t=y.bitArray.concat(t,[y.bitArray.partial(1,1)])).length+4;31&i;i++)t.push(0);for(t.push(0),t.push(0),t.push(Math.floor(this._length/4294967296)),t.push(0|this._length);t.length;)this._block(t.splice(0,32));return this.reset(),e},_init:[],_initr:[12372232,13281083,9762859,1914609,15106769,4090911,4308331,8266105],_key:[],_keyr:[2666018,15689165,5061423,9034684,4764984,380953,1658779,7176472,197186,7368638,14987916,16757986,8096111,1480369,13046325,6891156,15813330,5187043,9229749,11312229,2818677,10937475,4324308,1135541,6741931,11809296,16458047,15666916,11046850,698149,229999,945776,13774844,2541862,12856045,9810911,11494366,7844520,15576806,8533307,15795044,4337665,16291729,5553712,15684120,6662416,7413802,12308920,13816008,4303699,9366425,10176680,13195875,4295371,6546291,11712675,15708924,1519456,15772530,6568428,6495784,8568297,13007125,7492395,2515356,12632583,14740254,7262584,1535930,13146278,16321966,1853211,294276,13051027,13221564,1051980,4080310,6651434,14088940,4675607],_precompute:function(){var t,e=0,i=2;function n(t){return 4294967296*(t-Math.floor(t))|0}function r(t){return 1099511627776*(t-Math.floor(t))&255}t:for(;e<80;i++){for(t=2;t*t<=i;t++)if(i%t==0)continue t;e<8&&(this._init[2*e]=n(Math.pow(i,.5)),this._init[2*e+1]=r(Math.pow(i,.5))<<24|this._initr[e]),this._key[2*e]=n(Math.pow(i,1/3)),this._key[2*e+1]=r(Math.pow(i,1/3))<<24|this._keyr[e],e++}},_block:function(t){for(var f,u,e,l,i,n,d,p,b,r=t.slice(0),t=this._h,m=this._key,_=t[0],g=t[1],y=t[2],v=t[3],w=t[4],E=t[5],A=t[6],x=t[7],B=t[8],k=t[9],C=t[10],M=t[11],D=t[12],S=t[13],L=t[14],F=t[15],s=_,o=g,R=y,z=v,I=w,q=E,O=A,T=x,a=B,c=k,K=C,P=M,G=D,j=S,N=L,U=F,h=0;h<80;h++)h<16?(f=r[2*h],u=r[2*h+1]):(n=r[2*(h-15)],i=r[2*(h-15)+1],e=r[2*(h-2)],l=r[2*(h-2)+1],f=(f=((i<<31|n>>>1)^(i<<24|n>>>8)^n>>>7)+r[2*(h-7)]+((u=(n=(n<<31|i>>>1)^(n<<24|i>>>8)^(n<<25|i>>>7))+r[2*(h-7)+1])>>>0<n>>>0?1:0))+(((l<<13|e>>>19)^(e<<3|l>>>29)^e>>>6)+((u+=i=(e<<13|l>>>19)^(l<<3|e>>>29)^(e<<26|l>>>6))>>>0<i>>>0?1:0))+(r[2*(h-16)]+((u+=n=r[2*(h-16)+1])>>>0<n>>>0?1:0))),r[2*h]=f|=0,r[2*h+1]=u|=0,e=a&K^~a&G,l=c&P^~c&j,i=s&R^s&I^R&I,n=o&z^o&q^z&q,b=N+((c<<18|a>>>14)^(c<<14|a>>>18)^(a<<23|c>>>9))+((p=U+((a<<18|c>>>14)^(a<<14|c>>>18)^(c<<23|a>>>9)))>>>0<U>>>0?1:0),N=G,U=j,G=K,j=P,K=a,P=c,a=O+(b=(b+=e+((p+=l)>>>0<l>>>0?1:0))+(m[2*h]+((p+=d=m[2*h+1])>>>0<d>>>0?1:0))+(f+((p=p+u|0)>>>0<u>>>0?1:0)))+((c=T+p|0)>>>0<T>>>0?1:0)|0,O=I,T=q,I=R,q=z,s=b+((((z=o)<<4|(R=s)>>>28)^(s<<30|o>>>2)^(s<<25|o>>>7))+i+((b=(d=(s<<4|o>>>28)^(o<<30|s>>>2)^(o<<25|s>>>7))+n)>>>0<d>>>0?1:0))+((o=p+b|0)>>>0<p>>>0?1:0)|0;g=t[1]=g+o|0,t[0]=_+s+(g>>>0<o>>>0?1:0)|0,v=t[3]=v+z|0,t[2]=y+R+(v>>>0<z>>>0?1:0)|0,E=t[5]=E+q|0,t[4]=w+I+(E>>>0<q>>>0?1:0)|0,x=t[7]=x+T|0,t[6]=A+O+(x>>>0<T>>>0?1:0)|0,k=t[9]=k+c|0,t[8]=B+a+(k>>>0<c>>>0?1:0)|0,M=t[11]=M+P|0,t[10]=C+K+(M>>>0<P>>>0?1:0)|0,S=t[13]=S+j|0,t[12]=D+G+(S>>>0<j>>>0?1:0)|0,F=t[15]=F+U|0,t[14]=L+N+(F>>>0<U>>>0?1:0)|0}},y.hash.sha1=function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},y.hash.sha1.hash=function(t){return(new y.hash.sha1).update(t).finalize()},y.hash.sha1.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=y.codec.utf8String.toBits(t));for(var e=this._buffer=y.bitArray.concat(this._buffer,t),i=this._length,
n=this._length=i+y.bitArray.bitLength(t),r=this.blockSize+i&-this.blockSize;r<=n;r+=this.blockSize)this._block(e.splice(0,16));return this},finalize:function(){for(var t=this._buffer,e=this._h,i=(t=y.bitArray.concat(t,[y.bitArray.partial(1,1)])).length+2;15&i;i++)t.push(0);for(t.push(Math.floor(this._length/4294967296)),t.push(0|this._length);t.length;)this._block(t.splice(0,16));return this.reset(),e},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(t,e,i,n){return t<=19?e&i|~e&n:t<=39?e^i^n:t<=59?e&i|e&n|i&n:t<=79?e^i^n:void 0},_S:function(t,e){return e<<t|e>>>32-t},_block:function(t){for(var e,i=t.slice(0),t=this._h,n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],c=0;c<=79;c++)16<=c&&(i[c]=this._S(1,i[c-3]^i[c-8]^i[c-14]^i[c-16])),e=this._S(5,n)+this._f(c,r,s,o)+a+i[c]+this._key[Math.floor(c/20)]|0,a=o,o=s,s=this._S(30,r),r=n,n=e;t[0]=t[0]+n|0,t[1]=t[1]+r|0,t[2]=t[2]+s|0,t[3]=t[3]+o|0,t[4]=t[4]+a|0}},y.mode.ccm={name:"ccm",encrypt:function(t,e,i,n,r){var s,o=e.slice(0),a=y.bitArray,c=a.bitLength(i)/8,h=a.bitLength(o)/8;if(r=r||64,n=n||[],c<7)throw new y.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;s<4&&h>>>8*s;s++);return i=a.clamp(i,8*(15-(s=s<15-c?15-c:s))),c=y.mode.ccm._computeTag(t,e,i,n,r,s),o=y.mode.ccm._ctrMode(t,o,i,c,r,s),a.concat(o.data,o.tag)},decrypt:function(t,e,i,n,r){r=r||64,n=n||[];var s,o=y.bitArray,a=o.bitLength(i)/8,c=o.bitLength(e),h=o.clamp(e,c-r),e=o.bitSlice(e,c-r),c=(c-r)/8;if(a<7)throw new y.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;s<4&&c>>>8*s;s++);if(i=o.clamp(i,8*(15-(s=s<15-a?15-a:s))),h=y.mode.ccm._ctrMode(t,h,i,e,r,s),a=y.mode.ccm._computeTag(t,h.data,i,n,r,s),!o.equal(h.tag,a))throw new y.exception.corrupt("ccm: tag doesn't match");return h.data},_computeTag:function(t,e,f,i,n,r){var s,o,a=[],c=y.bitArray,h=c._xor4;if((n/=8)%2||n<4||16<n)throw new y.exception.invalid("ccm: invalid tag length");if(4294967295<i.length||4294967295<e.length)throw new y.exception.bug("ccm: can't deal with 4GiB or more data");if(s=[c.partial(8,(i.length?64:0)|n-2<<2|r-1)],(s=c.concat(s,f))[3]|=c.bitLength(e)/8,s=t.encrypt(s),i.length)for((r=c.bitLength(i)/8)<=65279?a=[c.partial(16,r)]:r<=4294967295&&(a=c.concat([c.partial(16,65534)],[r])),a=c.concat(a,i),o=0;o<a.length;o+=4)s=t.encrypt(h(s,a.slice(o,o+4).concat([0,0,0])));for(o=0;o<e.length;o+=4)s=t.encrypt(h(s,e.slice(o,o+4).concat([0,0,0])));return c.clamp(s,8*n)},_ctrMode:function(t,e,i,n,r,f){var s,o,a=y.bitArray,u=a._xor4,c=e.length,l=a.bitLength(e),h=a.concat([a.partial(8,f-1)],i).concat([0,0,0]).slice(0,4);if(n=a.bitSlice(u(n,t.encrypt(h)),0,r),!c)return{tag:n,data:[]};for(o=0;o<c;o+=4)h[3]++,s=t.encrypt(h),e[o]^=s[0],e[o+1]^=s[1],e[o+2]^=s[2],e[o+3]^=s[3];return{tag:n,data:a.clamp(e,l)}}},y.beware===undefined&&(y.beware={}),y.beware["CBC mode is dangerous because it doesn't protect message integrity."]=function(){y.mode.cbc={name:"cbc",encrypt:function(t,e,i,n){if(n&&n.length)throw new y.exception.invalid("cbc can't authenticate data");if(128!==y.bitArray.bitLength(i))throw new y.exception.invalid("cbc iv must be 128 bits");var r,n=y.bitArray,s=n._xor4,o=n.bitLength(e),a=0,c=[];if(7&o)throw new y.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(r=0;a+128<=o;r+=4,a+=128)i=t.encrypt(s(i,e.slice(r,r+4))),c.splice(r,0,i[0],i[1],i[2],i[3]);return i=t.encrypt(s(i,n.concat(e,[o=16843009*(16-(o>>3&15)),o,o,o]).slice(r,r+4))),c.splice(r,0,i[0],i[1],i[2],i[3]),c},decrypt:function(t,e,i,n){if(n&&n.length)throw new y.exception.invalid("cbc can't authenticate data");if(128!==y.bitArray.bitLength(i))throw new y.exception.invalid("cbc iv must be 128 bits");if(127&y.bitArray.bitLength(e)||!e.length)throw new y.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var r,s,o,a=y.bitArray,c=a._xor4,h=[];for(n=n||[],r=0;r<e.length;r+=4)s=e.slice(r,r+4),o=c(i,t.decrypt(s)),h.splice(r,0,o[0],o[1],o[2],o[3]),i=s;if(0===(s=255&h[r-1])||16<s)throw new y.exception.corrupt("pkcs#5 padding corrupt");if(!a.equal(a.bitSlice([o=16843009*s,o,o,o],0,8*s),a.bitSlice(h,32*h.length-8*s,32*h.length)))throw new y.exception.corrupt("pkcs#5 padding corrupt");return a.bitSlice(h,0,32*h.length-8*s)}}},y.mode.gcm={name:"gcm",encrypt:function(t,e,i,n,r){var e=e.slice(0),s=y.bitArray,t=y.mode.gcm._ctrMode(!0,t,e,n=n||[],i,r=r||128);return s.concat(t.data,t.tag)},decrypt:function(t,e,i,n,r){var s,e=e.slice(0),o=y.bitArray,a=o.bitLength(e);if(n=n||[],e=(r=r||128)<=a?(s=o.bitSlice(e,a-r),o.bitSlice(e,0,a-r)):(s=e,[]),a=y.mode.gcm._ctrMode(!1,t,e,n,i,r),!o.equal(a.tag,s))throw new y.exception.corrupt("gcm: tag doesn't match");return a.data},_galoisMultiply:function(t,e){for(var i,n,r=y.bitArray._xor4,s=[0,0,0,0],o=e.slice(0),a=0;a<128;a++){for(0!=(t[Math.floor(a/32)]&1<<31-a%32)&&(s=r(s,o)),n=0!=(1&o[3]),i=3;0<i;i--)o[i]=o[i]>>>1|(1&o[i-1])<<31;o[0]=o[0]>>>1,n&&(o[0]=o[0]^225<<24)}return s},_ghash:function(t,e,i){for(var n=i.length,r=e.slice(0),s=0;s<n;s+=4)r[0]^=4294967295&i[s],r[1]^=4294967295&i[s+1],r[2]^=4294967295&i[s+2],r[3]^=4294967295&i[s+3],r=y.mode.gcm._galoisMultiply(r,t);return r},_ctrMode:function(f,t,e,i,n,u){var r,s,o=y.bitArray,l=e.length,d=o.bitLength(e),p=o.bitLength(i),a=o.bitLength(n),c=t.encrypt([0,0,0,0]),h=96===a?(h=n.slice(0),o.concat(h,[1])):(h=y.mode.gcm._ghash(c,[0,0,0,0],n),y.mode.gcm._ghash(c,h,[0,0,Math.floor(a/4294967296),4294967295&a])),n=y.mode.gcm._ghash(c,[0,0,0,0],i),b=h.slice(0),a=n.slice(0);for(f||(a=y.mode.gcm._ghash(c,n,e)),s=0;s<l;s+=4)b[3]++,r=t.encrypt(b),e[s]^=r[0],e[s+1]^=r[1],e[s+2]^=r[2],e[s+3]^=r[3];return e=o.clamp(e,d),f&&(a=y.mode.gcm._ghash(c,n,e)),i=[Math.floor(p/4294967296),4294967295&p,Math.floor(d/4294967296),4294967295&d],a=y.mode.gcm._ghash(c,a,i),r=t.encrypt(h),a[0]^=r[0],a[1]^=r[1],a[2]^=r[2],a[3]^=r[3],{tag:o.bitSlice(a,0,u),data:e}}},y.misc.hmac=function(t,e){this._hash=e=e||y.hash.sha256;var i,n=[[],[]],r=e.prototype.blockSize/32;for(this._baseHash=[
new e,new e],t.length>r&&(t=e.hash(t)),i=0;i<r;i++)n[0][i]=909522486^t[i],n[1][i]=1549556828^t[i];this._baseHash[0].update(n[0]),this._baseHash[1].update(n[1]),this._resultHash=new e(this._baseHash[0])},y.misc.hmac.prototype.encrypt=y.misc.hmac.prototype.mac=function(t){if(this._updated)throw new y.exception.invalid("encrypt on already updated hmac called!");return this.update(t),this.digest(t)},y.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},y.misc.hmac.prototype.update=function(t){this._updated=!0,this._resultHash.update(t)},y.misc.hmac.prototype.digest=function(){var t=this._resultHash.finalize(),t=new this._hash(this._baseHash[1]).update(t).finalize();return this.reset(),t},y.misc.pbkdf2=function(t,e,i,n,r){if(i=i||1e3,n<0||i<0)throw y.exception.invalid("invalid params to pbkdf2");"string"==typeof t&&(t=y.codec.utf8String.toBits(t)),"string"==typeof e&&(e=y.codec.utf8String.toBits(e));for(var s,o,a,c,f=new(r=r||y.misc.hmac)(t),h=[],u=y.bitArray,l=1;32*h.length<(n||1);l++){for(s=o=f.encrypt(u.concat(e,[l])),a=1;a<i;a++)for(o=f.encrypt(o),c=0;c<o.length;c++)s[c]^=o[c];h=h.concat(s)}return h=n?u.clamp(h,n):h},y.prng=function(t){this._pools=[new y.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=undefined,this._defaultParanoia=t,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},y.prng.prototype={randomWords:function(t,e){var i,n,r=[],e=this.isReady(e);if(e===this._NOT_READY)throw new y.exception.notReady("generator isn't seeded");for(e&this._REQUIRES_RESEED&&this._reseedFromPools(!(e&this._READY)),i=0;i<t;i+=4)(i+1)%this._MAX_WORDS_PER_BURST==0&&this._gate(),n=this._gen4words(),r.push(n[0],n[1],n[2],n[3]);return this._gate(),r.slice(0,t)},setDefaultParanoia:function(t,e){if(0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e)throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=t},addEntropy:function(t,e,i){i=i||"user";var n,r,s,o=(new Date).valueOf(),a=this._robins[i],f=this.isReady(),c=0,h=this._collectorIds[i];switch(h===undefined&&(h=this._collectorIds[i]=this._collectorIdNext++),a===undefined&&(a=this._robins[i]=0),this._robins[i]=(this._robins[i]+1)%this._pools.length,typeof t){case"number":e===undefined&&(e=1),this._pools[a].update([h,this._eventId++,1,e,o,1,0|t]);break;case"object":if("[object Uint32Array]"===(s=Object.prototype.toString.call(t))){for(r=[],n=0;n<t.length;n++)r.push(t[n]);t=r}else for("[object Array]"!==s&&(c=1),n=0;n<t.length&&!c;n++)"number"!=typeof t[n]&&(c=1);if(!c){if(e===undefined)for(n=e=0;n<t.length;n++)for(r=t[n];0<r;)e++,r>>>=1;this._pools[a].update([h,this._eventId++,2,e,o,t.length].concat(t))}break;case"string":e===undefined&&(e=t.length),this._pools[a].update([h,this._eventId++,3,e,o,t.length]),this._pools[a].update(t);break;default:c=1}if(c)throw new y.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[a]+=e,this._poolStrength+=e,f===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){t=this._PARANOIA_LEVELS[t!==undefined?t:this._defaultParanoia];return this._strength&&this._strength>=t?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=t?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(t){t=this._PARANOIA_LEVELS[t||this._defaultParanoia];return this._strength>=t||this._poolStrength>t?1:this._poolStrength/t},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector),touchCollector:this._bind(this._touchCollector)},window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.addEventListener("touchmove",this._eventListener.touchCollector,!1);else{if(!document.attachEvent)throw new y.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.removeEventListener("touchmove",this._eventListener.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},
removeEventListener:function(t,e){var i,n,r=this._callbacks[t],s=[];for(n in r)r.hasOwnProperty(n)&&r[n]===e&&s.push(n);for(i=0;i<s.length;i++)delete r[n=s[i]]},_bind:function(t){var e=this;return function(){t.apply(e,arguments)}},_gen4words:function(){for(var t=0;t<4&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new y.cipher.aes(this._key)},_reseed:function(t){this._key=y.hash.sha256.hash(this._key.concat(t)),this._cipher=new y.cipher.aes(this._key);for(var e=0;e<4&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,i=[],n=0;for(this._nextReseed=i[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,e=0;e<16;e++)i.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(i=i.concat(this._pools[e].finalize()),n+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new y.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=n,n>this._strength&&(this._strength=n),this._reseedCount++,this._reseed(i)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(t){var e,i;try{e=t.x||t.clientX||t.offsetX||0,i=t.y||t.clientY||t.offsetY||0}catch(n){i=e=0}0!=e&&0!=i&&y.random.addEntropy([e,i],2,"mouse"),this._addCurrentTimeToEntropy(0)},_touchCollector:function(t){var t=t.touches[0]||t.changedTouches[0],e=t.pageX||t.clientX,t=t.pageY||t.clientY;y.random.addEntropy([e,t],1,"touch"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(t){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?y.random.addEntropy(window.performance.now(),t,"loadtime"):y.random.addEntropy((new Date).valueOf(),t,"loadtime")},_accelerometerCollector:function(t){var e,t=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z;window.orientation&&"number"==typeof(e=window.orientation)&&y.random.addEntropy(e,1,"accelerometer"),t&&y.random.addEntropy(t,2,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(t,e){var i,n=y.random._callbacks[t],r=[];for(i in n)n.hasOwnProperty(i)&&r.push(n[i]);for(i=0;i<r.length;i++)r[i](e)}},y.random=new y.prng(6),function(){try{var t,e,i;if("undefined"!=typeof module&&module.exports&&(e=function(){try{return require("crypto")}catch(t){return null}}())&&e.randomBytes)t=e.randomBytes(128),t=new Uint32Array(new Uint8Array(t).buffer),y.random.addEntropy(t,1024,"crypto.randomBytes");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(i=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(i);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)return;window.msCrypto.getRandomValues(i)}y.random.addEntropy(i,1024,"crypto.getRandomValues")}}catch(n){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(n))}}(),y.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},_encrypt:function(t,e,i,n){i=i||{},n=n||{};var r,s=y.json,o=s._add({iv:y.random.randomWords(4,0)},s.defaults);if(s._add(o,i),i=o.adata,"string"==typeof o.salt&&(o.salt=y.codec.base64.toBits(o.salt)),"string"==typeof o.iv&&(o.iv=y.codec.base64.toBits(o.iv)),!y.mode[o.mode]||!y.cipher[o.cipher]||"string"==typeof t&&o.iter<=100||64!==o.ts&&96!==o.ts&&128!==o.ts||128!==o.ks&&192!==o.ks&&256!==o.ks||o.iv.length<2||4<o.iv.length)throw new y.exception.invalid("json encrypt: invalid parameters");return"string"==typeof t?(t=(r=y.misc.cachedPbkdf2(t,o)).key.slice(0,o.ks/32),o.salt=r.salt):y.ecc&&t instanceof y.ecc.elGamal.publicKey&&(r=t.kem(),o.kemtag=r.tag,t=r.key.slice(0,o.ks/32)),"string"==typeof e&&(e=y.codec.utf8String.toBits(e)),"string"==typeof i&&(i=y.codec.utf8String.toBits(i)),r=new y.cipher[o.cipher](t),s._add(n,o),n.key=t,o.ct=y.mode[o.mode].encrypt(r,e,o.iv,i,o.ts),o},encrypt:function(t,e,i,n){var r=y.json,s=r._encrypt.apply(r,arguments);return r.encode(s)},_decrypt:function(t,e,i,n){i=i||{},n=n||{};var r,s=y.json,e=s._add(s._add(s._add({},s.defaults),e),i,!0),o=e.adata;if("string"==typeof e.salt&&(e.salt=y.codec.base64.toBits(e.salt)),"string"==typeof e.iv&&(e.iv=y.codec.base64.toBits(e.iv)),!y.mode[e.mode]||!y.cipher[e.cipher]||"string"==typeof t&&e.iter<=100||64!==e.ts&&96!==e.ts&&128!==e.ts||128!==e.ks&&192!==e.ks&&256!==e.ks||!e.iv||e.iv.length<2||4<e.iv.length)throw new y.exception.invalid("json decrypt: invalid parameters");return"string"==typeof t?(t=(r=y.misc.cachedPbkdf2(t,e)).key.slice(0,e.ks/32),e.salt=r.salt):y.ecc&&t instanceof y.ecc.elGamal.secretKey&&(t=t.unkem(y.codec.base64.toBits(e.kemtag)).slice(0,e.ks/32)),"string"==typeof o&&(o=y.codec.utf8String.toBits(o)),r=new y.cipher[e.cipher](t),r=y.mode[e.mode].decrypt(r,e.ct,e.iv,o,e.ts),s._add(n,e),n.key=t,1===i.raw?r:y.codec.utf8String.fromBits(r)},decrypt:function(t,e,i,n){var r=y.json;return r._decrypt(t,r.decode(e),i,n)},encode:function(t){var e,i="{",n="";for(e in t)if(t.hasOwnProperty(e)){if(!e.match(/^[a-z0-9]+$/i))throw new y.exception.invalid("json encode: invalid property name");switch(i+=n+'"'+e+'":',n=",",typeof t[e]){case"number":case"boolean":i+=t[e];break;case"string":i+='"'+escape(t[e])+'"';break;case"object":i+='"'+y.codec.base64.fromBits(t[e],0)+'"';break;default:throw new y.exception.bug("json encode: unsupported type")}}return i+"}"},decode:function(t){if(!(t=t.replace(/\s/g,"")).match(/^\{.*\}$/))throw new y.exception.invalid("json decode: this isn't json!");for(var e,i=t.replace(/^\{|\}$/g,"").split(/,/),n={},r=0;r<i.length;r++){if(!(e=i[r].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new y.exception.invalid(
"json decode: this isn't json!");e[3]?n[e[2]]=parseInt(e[3],10):e[4]?n[e[2]]=e[2].match(/^(ct|salt|iv)$/)?y.codec.base64.toBits(e[4]):unescape(e[4]):e[5]&&(n[e[2]]="true"===e[5])}return n},_add:function(t,e,i){if(t===undefined&&(t={}),e===undefined)return t;for(var n in e)if(e.hasOwnProperty(n)){if(i&&t[n]!==undefined&&t[n]!==e[n])throw new y.exception.invalid("required parameter overridden");t[n]=e[n]}return t},_subtract:function(t,e){var i,n={};for(i in t)t.hasOwnProperty(i)&&t[i]!==e[i]&&(n[i]=t[i]);return n},_filter:function(t,e){for(var i={},n=0;n<e.length;n++)t[e[n]]!==undefined&&(i[e[n]]=t[e[n]]);return i}},y.encrypt=y.json.encrypt,y.decrypt=y.json.decrypt,y.misc._pbkdf2Cache={},y.misc.cachedPbkdf2=function(t,e){var i=y.misc._pbkdf2Cache,n=(e=e||{}).iter||1e3;return(n=(i=i[t]=i[t]||{})[n]=i[n]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):y.random.randomWords(2,0)})[i=e.salt===undefined?n.firstSalt:e.salt]=n[i]||y.misc.pbkdf2(t,i,e.iter),{key:n[i].slice(0),salt:i.slice(0)}},y.bn=function(t){this.initWith(t)},y.bn.prototype={radix:24,maxMul:8,_class:y.bn,copy:function(){return new this._class(this)},initWith:function(t){var e,i=0;switch(typeof t){case"object":this.limbs=t.limbs.slice(0);break;case"number":this.limbs=[t],this.normalize();break;case"string":for(t=t.replace(/^0x/,""),this.limbs=[],e=this.radix/4,i=0;i<t.length;i+=e)this.limbs.push(parseInt(t.substring(Math.max(t.length-i-e,0),t.length-i),16));break;default:this.limbs=[0]}return this},equals:function(t){"number"==typeof t&&(t=new this._class(t));var e,i=0;for(this.fullReduce(),t.fullReduce(),e=0;e<this.limbs.length||e<t.limbs.length;e++)i|=this.getLimb(e)^t.getLimb(e);return 0===i},getLimb:function(t){return t>=this.limbs.length?0:this.limbs[t]},greaterEquals:function(t){"number"==typeof t&&(t=new this._class(t));for(var e,i,n=0,r=0,s=Math.max(this.limbs.length,t.limbs.length)-1;0<=s;s--)n|=(e=this.getLimb(s))-(i=t.getLimb(s))&~(r|=i-e&~n);return(r|~n)>>>31},toString:function(){this.fullReduce();for(var t,e="",i=this.limbs,n=0;n<this.limbs.length;n++){for(t=i[n].toString(16);n<this.limbs.length-1&&t.length<6;)t="0"+t;e=t+e}return"0x"+e},addM:function(t){"object"!=typeof t&&(t=new this._class(t));for(var e=this.limbs,i=t.limbs,n=e.length;n<i.length;n++)e[n]=0;for(n=0;n<i.length;n++)e[n]+=i[n];return this},doubleM:function(){for(var t,e=0,i=this.radix,n=this.radixMask,r=this.limbs,s=0;s<r.length;s++)t=r[s],r[s]=(t=t+t+e)&n,e=t>>i;return e&&r.push(e),this},halveM:function(){for(var t,e=0,i=this.radix,n=this.limbs,r=n.length-1;0<=r;r--)t=n[r],n[r]=t+e>>1,e=(1&t)<<i;return n[n.length-1]||n.pop(),this},subM:function(t){"object"!=typeof t&&(t=new this._class(t));for(var e=this.limbs,i=t.limbs,n=e.length;n<i.length;n++)e[n]=0;for(n=0;n<i.length;n++)e[n]-=i[n];return this},mod:function(t){var e,i,n=!this.greaterEquals(new y.bn(0));for(t=new y.bn(t).normalize(),e=new y.bn(this).normalize(),i=0,n&&(e=new y.bn(0).subM(e).normalize());e.greaterEquals(t);i++)t.doubleM();for(n&&(e=t.sub(e).normalize());0<i;i--)t.halveM(),e.greaterEquals(t)&&e.subM(t).normalize();return e.trim()},inverseMod:function(t){var e,i,n=new y.bn(1),r=new y.bn(0),s=new y.bn(this),o=new y.bn(t),a=1;if(!(1&t.limbs[0]))throw new y.exception.invalid("inverseMod: p must be odd");do{for(1&s.limbs[0]&&(s.greaterEquals(o)||(e=s,s=o,o=e,e=n,n=r,r=e),s.subM(o),s.normalize(),n.greaterEquals(r)||n.addM(t),n.subM(r)),s.halveM(),1&n.limbs[0]&&n.addM(t),n.normalize(),n.halveM(),i=a=0;i<s.limbs.length;i++)a|=s.limbs[i]}while(a);if(!o.equals(1))throw new y.exception.invalid("inverseMod: p and x must be relatively prime");return r},add:function(t){return this.copy().addM(t)},sub:function(t){return this.copy().subM(t)},mul:function(t){"number"==typeof t&&(t=new this._class(t));for(var e,i,n=this.limbs,r=t.limbs,s=n.length,f=r.length,o=new this._class,a=o.limbs,c=this.maxMul,h=0;h<this.limbs.length+t.limbs.length+1;h++)a[h]=0;for(h=0;h<s;h++){for(i=n[h],e=0;e<f;e++)a[h+e]+=i*r[e];--c||(c=this.maxMul,o.cnormalize())}return o.cnormalize().reduce()},square:function(){return this.mul(this)},power:function(t){"number"==typeof t?t=[t]:t.limbs!==undefined&&(t=t.normalize().limbs);for(var e,i=new this._class(1),n=this,r=0;r<t.length;r++)for(e=0;e<this.radix;e++)t[r]&1<<e&&(i=i.mul(n)),n=n.square();return i},mulmod:function(t,e){return this.mod(e).mul(t.mod(e)).mod(e)},powermod:function(t,e){for(var i=new y.bn(1),n=new y.bn(this),r=new y.bn(t);1&r.limbs[0]&&(i=i.mulmod(n,e)),r.halveM(),!r.equals(0);)n=n.mulmod(n,e);return i.normalize().reduce()},trim:function(){for(var t,e=this.limbs;t=e.pop(),e.length&&0===t;);return e.push(t),this},reduce:function(){return this},fullReduce:function(){return this.normalize()},normalize:function(){for(var t,e=0,i=this.placeVal,n=this.ipv,r=this.limbs,s=r.length,o=this.radixMask,a=0;a<s||0!==e&&-1!==e;a++)e=((t=(r[a]||0)+e)-(r[a]=t&o))*n;return-1===e&&(r[a-1]-=i),this},cnormalize:function(){for(var t,e=0,i=this.ipv,n=this.limbs,r=n.length,s=this.radixMask,o=0;o<r-1;o++)e=((t=n[o]+e)-(n[o]=t&s))*i;return n[o]+=e,this},toBits:function(t){this.fullReduce(),t=t||this.exponent||this.bitLength();var e=Math.floor((t-1)/24),i=y.bitArray,n=(t+7&-8)%this.radix||this.radix,r=[i.partial(n,this.getLimb(e))];for(e--;0<=e;e--)r=i.concat(r,[i.partial(Math.min(this.radix,t),this.getLimb(e))]),t-=this.radix;return r},bitLength:function(){this.fullReduce();for(var t=this.radix*(this.limbs.length-1),e=this.limbs[this.limbs.length-1];e;e>>>=1)t++;return t+7&-8}},y.bn.fromBits=function(t){var e=new this,i=[],n=y.bitArray,r=this.prototype,s=Math.min(this.bitLength||4294967296,n.bitLength(t)),o=s%r.radix||r.radix;for(i[0]=n.extract(t,0,o);o<s;o+=r.radix)i.unshift(n.extract(t,o,r.radix));return e.limbs=i,e},y.bn.prototype.ipv=1/(y.bn.prototype.placeVal=Math.pow(2,y.bn.prototype.radix)),y.bn.prototype.radixMask=(1<<y.bn.prototype.radix)-1,y.bn.pseudoMersennePrime=function(t,e){function i(t){this.initWith(t)}var n,r,s=i.prototype=new y.bn,o=s.modOffset=Math.ceil(r=t/s.radix);
for(s.exponent=t,s.offset=[],s.factor=[],s.minOffset=o,s.fullMask=0,s.fullOffset=[],s.fullFactor=[],s.modulus=i.modulus=new y.bn(Math.pow(2,t)),s.fullMask=0|-Math.pow(2,t%s.radix),n=0;n<e.length;n++)s.offset[n]=Math.floor(e[n][0]/s.radix-r),s.fullOffset[n]=Math.ceil(e[n][0]/s.radix-r),s.factor[n]=e[n][1]*Math.pow(.5,t-e[n][0]+s.offset[n]*s.radix),s.fullFactor[n]=e[n][1]*Math.pow(.5,t-e[n][0]+s.fullOffset[n]*s.radix),s.modulus.addM(new y.bn(Math.pow(2,e[n][0])*e[n][1])),s.minOffset=Math.min(s.minOffset,-s.offset[n]);return s._class=i,s.modulus.cnormalize(),s.reduce=function(){for(var t,e,i,n=this.modOffset,r=this.limbs,s=this.offset,o=this.offset.length,a=this.factor,c=this.minOffset;r.length>n;){for(e=r.pop(),i=r.length,t=0;t<o;t++)r[i+s[t]]-=a[t]*e;--c||(r.push(0),this.cnormalize(),c=this.minOffset)}return this.cnormalize(),this},s._strongReduce=-1===s.fullMask?s.reduce:function(){var t,e,i=this.limbs,n=i.length-1;if(this.reduce(),n==this.modOffset-1){for(e=i[n]&this.fullMask,i[n]-=e,t=0;t<this.fullOffset.length;t++)i[n+this.fullOffset[t]]-=this.fullFactor[t]*e;this.normalize()}},s.fullReduce=function(){var t,e;for(this._strongReduce(),this.addM(this.modulus),this.addM(this.modulus),this.normalize(),this._strongReduce(),e=this.limbs.length;e<this.modOffset;e++)this.limbs[e]=0;for(t=this.greaterEquals(this.modulus),e=0;e<this.limbs.length;e++)this.limbs[e]-=this.modulus.limbs[e]*t;return this.cnormalize(),this},s.inverse=function(){return this.power(this.modulus.sub(2))},i.fromBits=y.bn.fromBits,i},i=y.bn.pseudoMersennePrime,y.bn.prime={p127:i(127,[[0,-1]]),p25519:i(255,[[0,-19]]),p192k:i(192,[[32,-1],[12,-1],[8,-1],[7,-1],[6,-1],[3,-1],[0,-1]]),p224k:i(224,[[32,-1],[12,-1],[11,-1],[9,-1],[7,-1],[4,-1],[1,-1],[0,-1]]),p256k:i(256,[[32,-1],[9,-1],[8,-1],[7,-1],[6,-1],[4,-1],[0,-1]]),p192:i(192,[[0,-1],[64,-1]]),p224:i(224,[[0,1],[96,-1]]),p256:i(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:i(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:i(521,[[0,-1]])},y.bn.random=function(t,e){for(var i,n,r=(t="object"!=typeof t?new y.bn(t):t).limbs.length,s=t.limbs[r-1]+1,o=new y.bn;;){for(;(i=y.random.randomWords(r,e))[r-1]<0&&(i[r-1]+=4294967296),Math.floor(i[r-1]/s)===Math.floor(4294967296/s););for(i[r-1]%=s,n=0;n<r-1;n++)i[n]&=t.radixMask;if(o.limbs=i,!o.greaterEquals(t))return o}},y.ecc={},y.ecc.point=function(t,e,i){e===undefined?this.isIdentity=!0:(e instanceof y.bn&&(e=new t.field(e)),i instanceof y.bn&&(i=new t.field(i)),this.x=e,this.y=i,this.isIdentity=!1),this.curve=t},y.ecc.point.prototype={toJac:function(){return new y.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function(t){return this.toJac().mult(t,this).toAffine()},mult2:function(t,e,i){return this.toJac().mult2(t,this,e,i).toAffine()},multiples:function(){var t,e,i;if(this._multiples===undefined)for(i=this.toJac().doubl(),t=this._multiples=[new y.ecc.point(this.curve),this,i.toAffine()],e=3;e<16;e++)i=i.add(this),t.push(i.toAffine());return this._multiples},isValid:function(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},toBits:function(){return y.bitArray.concat(this.x.toBits(),this.y.toBits())}},y.ecc.pointJac=function(t,e,i,n){e===undefined?this.isIdentity=!0:(this.x=e,this.y=i,this.z=n,this.isIdentity=!1),this.curve=t},y.ecc.pointJac.prototype={add:function(t){var e,i,n,r,s=this;if(s.curve!==t.curve)throw"sjcl.ecc.add(): Points must be on the same curve to add them!";return s.isIdentity?t.toJac():t.isIdentity?s:(r=s.z.square(),(e=t.x.mul(r).subM(s.x)).equals(0)?s.y.equals(t.y.mul(r.mul(s.z)))?s.doubl():new y.ecc.pointJac(s.curve):(r=t.y.mul(r.mul(s.z)).subM(s.y),t=e.square(),n=r.square(),i=e.square().mul(e).addM(s.x.add(s.x).mul(t)),i=n.subM(i),n=s.x.mul(t).subM(i).mul(r),t=s.y.mul(e.square().mul(e)),r=n.subM(t),t=s.z.mul(e),new y.ecc.pointJac(this.curve,i,r,t)))},doubl:function(){if(this.isIdentity)return this;var t=this.y.square(),e=t.mul(this.x.mul(4)),t=t.square().mul(8),i=this.z.square(),i=this.curve.a.toString()==new y.bn(-3).toString()?this.x.sub(i).mul(3).mul(this.x.add(i)):this.x.square().mul(3).add(i.square().mul(this.curve.a)),n=i.square().subM(e).subM(e),e=e.sub(n).mul(i).subM(t),i=this.y.add(this.y).mul(this.z);return new y.ecc.pointJac(this.curve,n,e,i)},toAffine:function(){if(this.isIdentity||this.z.equals(0))return new y.ecc.point(this.curve);var t=this.z.inverse(),e=t.square();return new y.ecc.point(this.curve,this.x.mul(e).fullReduce(),this.y.mul(e.mul(t)).fullReduce())},mult:function(t,e){"number"==typeof t?t=[t]:t.limbs!==undefined&&(t=t.normalize().limbs);for(var i,n=new y.ecc.point(this.curve).toJac(),r=e.multiples(),s=t.length-1;0<=s;s--)for(i=y.bn.prototype.radix-4;0<=i;i-=4)n=n.doubl().doubl().doubl().doubl().add(r[t[s]>>i&15]);return n},mult2:function(t,e,i,n){"number"==typeof t?t=[t]:t.limbs!==undefined&&(t=t.normalize().limbs),"number"==typeof i?i=[i]:i.limbs!==undefined&&(i=i.normalize().limbs);for(var r,s,o,a=new y.ecc.point(this.curve).toJac(),c=e.multiples(),f=n.multiples(),h=Math.max(t.length,i.length)-1;0<=h;h--)for(s=0|t[h],o=0|i[h],r=y.bn.prototype.radix-4;0<=r;r-=4)a=a.doubl().doubl().doubl().doubl().add(c[s>>r&15]).add(f[o>>r&15]);return a},isValid:function(){var t=this.z.square(),e=t.square(),t=e.mul(t);return this.y.square().equals(this.curve.b.mul(t).add(this.x.mul(this.curve.a.mul(e).add(this.x.square()))))}},y.ecc.curve=function(t,e,i,n,r,s){this.field=t,this.r=new y.bn(e),this.a=new t(i),this.b=new t(n),this.G=new y.ecc.point(this,new t(r),new t(s))},y.ecc.curve.prototype.fromBits=function(t){var e=y.bitArray,i=this.field.prototype.exponent+7&-8,t=new y.ecc.point(this,this.field.fromBits(e.bitSlice(t,0,i)),this.field.fromBits(e.bitSlice(t,i,2*i)));if(!t.isValid())throw new y.exception.corrupt("not on the curve!");return t},y.ecc.curves={c192:new y.ecc.curve(y.bn.prime.p192,"0xffffffffffffffffffffffff99def836146bc9b1b4d22831",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1",
"0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new y.ecc.curve(y.bn.prime.p224,"0xffffffffffffffffffffffffffff16a2e0b8f03e13dd29455c5c2a3d",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),c256:new y.ecc.curve(y.bn.prime.p256,"0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new y.ecc.curve(y.bn.prime.p384,"0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),k192:new y.ecc.curve(y.bn.prime.p192k,"0xfffffffffffffffffffffffe26f2fc170f69466a74defd8d",0,3,"0xdb4ff10ec057e9ae26b07d0280b7f4341da5d1b1eae06c7d","0x9b2f2f6d9c5628a7844163d015be86344082aa88d95e2f9d"),k224:new y.ecc.curve(y.bn.prime.p224k,"0x010000000000000000000000000001dce8d2ec6184caf0a971769fb1f7",0,5,"0xa1455b334df099df30fc28a169a467e9e47075a90f7e650eb6b7a45c","0x7e089fed7fba344282cafbd6f7e319f7c0b0bd59e2ca4bdb556d61a5"),k256:new y.ecc.curve(y.bn.prime.p256k,"0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",0,7,"0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},y.ecc.basicKey={publicKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),e instanceof Array?this._point=t.fromBits(e):this._point=e,this.get=function(){var t=this._point.toBits(),e=y.bitArray.bitLength(t),i=y.bitArray.bitSlice(t,0,e/2),t=y.bitArray.bitSlice(t,e/2);return{x:i,y:t}}},secretKey:function(t,e){this._curve=t,this._curveBitLength=t.r.bitLength(),this._exponent=e,this.get=function(){return this._exponent.toBits()}}},y.ecc.basicKey.generateKeys=function(n){return function(t,e,i){if("number"==typeof(t=t||256)&&(t=y.ecc.curves["c"+t])===undefined)throw new y.exception.invalid("no such curve");i=i||y.bn.random(t.r,e);e=t.G.mult(i);return{pub:new y.ecc[n].publicKey(t,e),sec:new y.ecc[n].secretKey(t,i)}}},y.ecc.elGamal={generateKeys:y.ecc.basicKey.generateKeys("elGamal"),publicKey:function(t,e){y.ecc.basicKey.publicKey.apply(this,arguments)},secretKey:function(t,e){y.ecc.basicKey.secretKey.apply(this,arguments)}},y.ecc.elGamal.publicKey.prototype={kem:function(t){var t=y.bn.random(this._curve.r,t),e=this._curve.G.mult(t).toBits();return{key:y.hash.sha256.hash(this._point.mult(t).toBits()),tag:e}}},y.ecc.elGamal.secretKey.prototype={unkem:function(t){return y.hash.sha256.hash(this._curve.fromBits(t).mult(this._exponent).toBits())},dh:function(t){return y.hash.sha256.hash(t._point.mult(this._exponent).toBits())},dhJavaEc:function(t){return t._point.mult(this._exponent).x.toBits()}},y.ecc.ecdsa={generateKeys:y.ecc.basicKey.generateKeys("ecdsa")},y.ecc.ecdsa.publicKey=function(t,e){y.ecc.basicKey.publicKey.apply(this,arguments)},y.ecc.ecdsa.publicKey.prototype={verify:function(t,e,i){y.bitArray.bitLength(t)>this._curveBitLength&&(t=y.bitArray.clamp(t,this._curveBitLength));var n=y.bitArray,r=this._curve.r,s=this._curveBitLength,o=y.bn.fromBits(n.bitSlice(e,0,s)),s=y.bn.fromBits(n.bitSlice(e,s,2*s)),n=i?s:s.inverseMod(r),a=y.bn.fromBits(t).mul(n).mod(r),n=o.mul(n).mod(r),a=this._curve.G.mult2(a,n,this._point).x;if(o.equals(0)||s.equals(0)||o.greaterEquals(r)||s.greaterEquals(r)||!a.equals(o)){if(i===undefined)return this.verify(t,e,!0);throw new y.exception.corrupt("signature didn't check out")}return!0}},y.ecc.ecdsa.secretKey=function(t,e){y.ecc.basicKey.secretKey.apply(this,arguments)},y.ecc.ecdsa.secretKey.prototype={sign:function(t,e,i,n){y.bitArray.bitLength(t)>this._curveBitLength&&(t=y.bitArray.clamp(t,this._curveBitLength));var r=this._curve.r,s=r.bitLength(),n=n||y.bn.random(r.sub(1),e).add(1),e=this._curve.G.mult(n).x.mod(r),t=y.bn.fromBits(t).add(e.mul(this._exponent)),i=(i?t.inverseMod(r).mul(n):t.mul(n.inverseMod(r))).mod(r);return y.bitArray.concat(e.toBits(s),i.toBits(s))}},y.keyexchange.srp={makeVerifier:function(t,e,i,n){t=y.keyexchange.srp.makeX(t,e,i);return t=y.bn.fromBits(t),n.g.powermod(t,n.N)},makeX:function(t,e,i){t=y.hash.sha1.hash(t+":"+e);return y.hash.sha1.hash(y.bitArray.concat(i,t))},knownGroup:function(t){return"string"!=typeof t&&(t=t.toString()),y.keyexchange.srp._didInitKnownGroups||y.keyexchange.srp._initKnownGroups(),y.keyexchange.srp._knownGroups[t]},_didInitKnownGroups:!1,_initKnownGroups:function(){for(var t,e=0;e<y.keyexchange.srp._knownGroupSizes.length;e++)t=y.keyexchange.srp._knownGroupSizes[e].toString(),(t=y.keyexchange.srp._knownGroups[t]).N=new y.bn(t.N),t.g=new y.bn(t.g);y.keyexchange.srp._didInitKnownGroups=!0},_knownGroupSizes:[1024,1536,2048],_knownGroups:{1024:{N:"EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE48E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B297BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9AFD5138FE8376435B9FC61D2FC0EB06E3",g:2},1536:{N:"9DEF3CAFB939277AB1F12A8617A47BBBDBA51DF499AC4C80BEEEA9614B19CC4D5F4F5F556E27CBDE51C6A94BE4607A291558903BA0D0F84380B655BB9A22E8DCDF028A7CEC67F0D08134B1C8B97989149B609E0BE3BAB63D47548381DBC5B1FC764E3F4B53DD9DA1158BFD3E2B9C8CF56EDF019539349627DB2FD53D24B7C48665772E437D6C7F8CE442734AF7CCB7AE837C264AE3A9BEB87F8A2FE9B8B5292E5A021FFF5E91479E8CE7A28C2442C6F315180F93499A234DCF76E3FED135F9BB",g:2},2048:{
N:"AC6BDB41324A9A9BF166DE5E1389582FAF72B6651987EE07FC3192943DB56050A37329CBB4A099ED8193E0757767A13DD52312AB4B03310DCD7F48A9DA04FD50E8083969EDB767B0CF6095179A163AB3661A05FBD5FAAAE82918A9962F0B93B855F97993EC975EEAA80D740ADBF4FF747359D041D5C33EA71D281E446B14773BCA97B43A23FB801676BD207A436C6481F1D2B9078717461A5B9D32E688F87748544523B524B0D57D5EA77A2775D2ECFA032CFBDBF52FB3786160279004E57AE6AF874E7303CE53299CCC041C7BC308D82A5698F3A8D0C38271AE35F8E9DBFBB694B5C803D89F7AE435DE236D525F54759B65E372FCD68EF20FA7111F9E4AFF73",g:2}}},t.Crypto=t.Crypto||{},t.Crypto.sjcl=y},"@VERSION@",{requires:[]});